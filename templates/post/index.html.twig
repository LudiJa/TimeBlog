{% extends 'base.html.twig' %}

{% block title %}Hello !
{% endblock %}

{% block body %}
	<h2>Liste des posts :</h2>
	{% for post in posts %}
		<div class="border border-dark my-2 flex rounded bg-light">
			<div class="card-header pb-2">
				<p>@{{post.user.username}}</p>
			</div>
			{% if post.mediaName is empty %}
			{% else %}
			<img class="mx-auto d-block p-1 img-fluid" src={{vich_uploader_asset(post)}} alt="Card image">
			{% endif %}
			<div class="card-body">
				<h3>{{post.content}}</h3>
			</div>
			<div class="card-footer">
				<div
					class="d-flex gap-2">
					{# like #}
					<a href={{ path('app_post_like', {'id': post.id} )}} class="btn btn-light">
						{% if app.user in post.likes %}
							<i class="fas fa-heart" style="color:red;"></i>
						{% else %}
							<i class="far fa-heart"></i>
						{% endif %}
					</a>
					{# details and delete #}
					<a class="btn btn-outline-info" href={{ path('app_post_details',{'id':post.id} ) }}><i class="fas fa-comments"></i></a>
					{% if app.user %}
						{% if app.user is same as(post.user) %}
							<a class="btn btn-outline-secondary" href={{ path('app_post_edit',{'id':post.id} ) }}>
								<i class="fas fa-wrench"></i>
							</a>

							<form method="post" action={{ path('app_post_delete',{'id': post.id} ) }}>
								<input type="hidden" name="_token" value={{csrf_token('delete' ~ post.id)}}>
								<button type="submit" class="btn btn-outline-danger">
									<i class="fas fa-trash-alt"></i>
								</button>
							</form>
						{% endif %}
					{% endif %}
					<p class="align-items-center">
						<small>{{post.createdAt | date('d/m/Y H:i:s')}}</small>
					</p>
				</div>
			</div>
		</div>
	{% endfor %}
{% endblock %}
